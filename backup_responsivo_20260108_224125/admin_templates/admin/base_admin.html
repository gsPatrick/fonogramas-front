<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Admin - Sistema Fonogramas{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <div class="admin-layout">
        <!-- Overlay mobile -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Sidebar Admin -->
        <nav class="sidebar-admin" id="sidebarAdmin">
            <div class="sidebar-admin__header">
                <span class="sidebar-admin__badge">
                    <i class="bi bi-shield-lock"></i> ADMIN
                </span>
            </div>

            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if request.endpoint == 'admin.dashboard' }}"
                        href="{{ url_for('admin.dashboard') }}">
                        <i class="bi bi-speedometer2"></i> Dashboard
                    </a>
                </li>

                <li class="sidebar-admin__section">ECAD</li>
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if 'envio' in request.endpoint|default('') }}"
                        href="{{ url_for('admin.listar_envios') }}">
                        <i class="bi bi-send"></i> Envios
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if 'retorno' in request.endpoint|default('') }}"
                        href="{{ url_for('admin.upload_retorno') }}">
                        <i class="bi bi-download"></i> Retornos
                    </a>
                </li>

                <li class="sidebar-admin__section">GESTÃO</li>
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if 'lote' in request.endpoint|default('') }}"
                        href="{{ url_for('admin.operacoes_lote') }}">
                        <i class="bi bi-stack"></i> Operações em Lote
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if 'auditoria' in request.endpoint|default('') }}"
                        href="{{ url_for('admin.auditoria_geral') }}">
                        <i class="bi bi-journal-text"></i> Auditoria
                    </a>
                </li>

                <li class="sidebar-admin__section">RELATÓRIOS</li>
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if 'relatorio' in request.endpoint|default('') }}"
                        href="{{ url_for('admin.menu_relatorios') }}">
                        <i class="bi bi-bar-chart"></i> Relatórios
                    </a>
                </li>

                <li class="sidebar-admin__section">CONFIGURAÇÕES</li>
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if 'usuario' in request.endpoint|default('') }}"
                        href="{{ url_for('admin.gerenciar_usuarios') }}">
                        <i class="bi bi-people"></i> Usuários
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link {{ 'active' if 'enum' in request.endpoint|default('') }}"
                        href="{{ url_for('admin.gerenciar_enums') }}">
                        <i class="bi bi-gear"></i> Sistema
                    </a>
                </li>
            </ul>

            <hr class="sidebar-admin__divider">

            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link nav-link--warning" href="{{ url_for('usuario.dashboard') }}">
                        <i class="bi bi-arrow-left"></i> Painel Usuário
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link--danger" href="{{ url_for('auth.logout') }}">
                        <i class="bi bi-box-arrow-right"></i> Sair
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Mobile Toggle -->
            <button class="sidebar-toggle d-md-none" id="sidebarToggle">
                <i class="bi bi-list"></i>
            </button>

            <div class="admin-header">
                <h1 class="admin-header__title">{% block page_title %}Dashboard{% endblock %}</h1>
                <div class="admin-header__actions">
                    {% block page_actions %}{% endblock %}
                </div>
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="admin-alerts">
                {% for category, message in messages %}
                <div class="alert alert-{{ category }} alert-dismissible fade show">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% endwith %}

            <div class="admin-content">
                {% block content %}{% endblock %}
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sidebar toggle mobile
        document.getElementById('sidebarToggle')?.addEventListener('click', function () {
            document.getElementById('sidebarAdmin').classList.toggle('show');
            document.getElementById('sidebarOverlay').classList.toggle('show');
        });

        document.getElementById('sidebarOverlay')?.addEventListener('click', function () {
            document.getElementById('sidebarAdmin').classList.remove('show');
            this.classList.remove('show');
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>

</html>